<!DOCTYPE html>
<html lang="zh-CN" class="no-js">
<head>
	<meta charset="UTF-8">
	<base href="https://www.biglee.cn/">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="profile" href="http://gmpg.org/xfn/11">
		<script>(function(html){html.className = html.className.replace(/\bno-js\b/,'js')})(document.documentElement);</script>
<title>网站技术 &#8211; 第6页 &#8211; 网站建设技术集锦</title>
<link rel='dns-prefetch' href='//s.w.org'>
<link rel="alternate" type="application/rss+xml" title="网站建设技术集锦 &raquo; Feed" href="/feed" />
<link rel="alternate" type="application/rss+xml" title="网站建设技术集锦 &raquo; 评论Feed" href="/comments/feed" />
<link rel="alternate" type="application/rss+xml" title="网站建设技术集锦 &raquo; 网站技术分类目录Feed" href="/blog/category/web_development/feed" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='genericons-css'  href='/wp-content/themes/twentysixteen/genericons/genericons.css?ver=3.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='twentysixteen-style-css'  href='/wp-content/themes/twentysixteen/style.css?ver=4.6' type='text/css' media='all' />
<!--[if lt IE 10]>
<link rel='stylesheet' id='twentysixteen-ie-css'  href='/wp-content/themes/twentysixteen/css/ie.css?ver=20160816' type='text/css' media='all' />
<![endif]-->
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentysixteen-ie8-css'  href='/wp-content/themes/twentysixteen/css/ie8.css?ver=20160816' type='text/css' media='all' />
<![endif]-->
<!--[if lt IE 8]>
<link rel='stylesheet' id='twentysixteen-ie7-css'  href='/wp-content/themes/twentysixteen/css/ie7.css?ver=20160816' type='text/css' media='all' />
<![endif]-->
<!--[if lt IE 9]>
<script type='text/javascript' src='/wp-content/themes/twentysixteen/js/html5.js?ver=3.7.3'></script>
<![endif]-->
<script type='text/javascript' src='/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 4.6" />
		<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
		</head>

<body class="archive paged category category-web_development category-9 paged-6 category-paged-6 hfeed">
<div id="page" class="site">
	<div class="site-inner">
		<a class="skip-link screen-reader-text" href="#content">跳至内容</a>

		<header id="masthead" class="site-header" role="banner">
			<div class="site-header-main">
				<div class="site-branding">
					
											<p class="site-title"><a href="/" rel="home">网站建设技术集锦</a></p>
											<p class="site-description">涉及网站建设、服务器维护等IT技术的博客</p>
									</div><!-- .site-branding -->

									<button id="menu-toggle" class="menu-toggle">菜单</button>

					<div id="site-header-menu" class="site-header-menu">
													<nav id="site-navigation" class="main-navigation" role="navigation" aria-label="主菜单">
								<div class="menu-%e5%af%bc%e8%88%aa-container"><ul id="menu-%e5%af%bc%e8%88%aa" class="primary-menu"><li id="menu-item-309" class="menu-item menu-item-type-taxonomy menu-item-object-category current-menu-item menu-item-309"><a href="/blog/category/web_development">网站技术</a></li>
<li id="menu-item-310" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-310"><a href="/blog/category/pc_technology">PC技术</a></li>
<li id="menu-item-311" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-311"><a href="/blog/category/orther">杂货铺</a></li>
<li id="menu-item-312" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-312"><a href="/blog/category/entertainment">影音娱乐</a></li>
<li id="menu-item-313" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-313"><a href="/blog/category/life">网络生活</a></li>
<li id="menu-item-314" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-314"><a href="/blog/category/digest">文摘</a></li>
<li id="menu-item-315" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-315"><a href="/blog/category/database">数据库</a></li>
<li id="menu-item-316" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-316"><a href="/blog/category/network">网络安全</a></li>
<li id="menu-item-317" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-317"><a href="/blog/category/management">管理营运</a></li>
<li id="menu-item-318" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-318"><a href="/blog/category/dotnet">.Net</a></li>
<li id="menu-item-323" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-323"><a href="/about_me">关于我</a></li>
</ul></div>							</nav><!-- .main-navigation -->
						
											</div><!-- .site-header-menu -->
							</div><!-- .site-header-main -->

					</header><!-- .site-header -->

		<div id="content" class="site-content">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			<header class="page-header">
				<h1 class="page-title">分类：网站技术</h1>			</header><!-- .page-header -->

			
<article id="post-223" class="post-223 post type-post status-publish format-standard hentry category-web_development">
	<header class="entry-header">
		
		<h2 class="entry-title"><a href="/blog/2012/223.html" rel="bookmark">基于jQuery与PHP实现Ajax长轮询(LongPoll)</a></h2>	</header><!-- .entry-header -->

	
	
	<div class="entry-content">
		<p>传统的AJAX轮询方式，客服端以用户定义的时间间隔去服务器上查询最新的数据。种这种拉取数据的方式需要很短的时间间隔才能保证数据的精确度，但太短的时间间隔客服端会对服务器在短时间内发送出多个请求。</p>
<p>反转AJAX，就是所谓的长轮询或者COMET。服务器与客服端需要保持一条长时间的请求，它使得服务器在有数据时可以返回消息给客户端。</p>
<p><strong>XHTML</strong></p>
<pre><ol class="dp-xml"><li class="alt"><span><font color="#000000"><span class="tag">&lt;</span><span class="tag-name">div</span><span>&nbsp;</span><span class="attribute">id</span><span>=</span><span class="attribute-value">&quot;msg&quot;</span><span class="tag">&gt;</span><span class="tag">&lt;/</span><span class="tag-name">div</span><span class="tag">&gt;</span><span>&nbsp;&nbsp;&nbsp; &nbsp;</span></font></span></li><li><font color="#000000"><span class="tag">&lt;</span><span class="tag-name">input</span><span>&nbsp;</span><span class="attribute">id</span><span>=</span><span class="attribute-value">&quot;btn&quot;</span><span>&nbsp;</span><span class="attribute">type</span><span>=</span><span class="attribute-value">&quot;button&quot;</span><span>&nbsp;</span><span class="attribute">value</span><span>=</span><span class="attribute-value">&quot;测试&quot;</span><span>&nbsp;</span><span class="tag">/&gt;</span><span>&nbsp;</span></font></li></ol></pre>
<p><strong>jQuery</strong></p>
<p>这里使用AJAX请求data.php页面获得&lsquo;success&rsquo;的值,请求的时间达到80秒。在这80秒中若没有从服务端返回&lsquo;success&rsquo;则一直保持连接状态，直到有数据返回或&lsquo;success&rsquo;的值为0才关闭连接。在关闭连接后在继续下一次的请求。</p>
<pre><ol class="dp-c"><li class="alt"><span><span>$(</span><font color="#000000"><span class="keyword">function</span><span>(){&nbsp; &nbsp;</span></font></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;$(</span><font color="#000000"><span class="string">&quot;#btn&quot;</span><span>).bind(</span><span class="string">&quot;click&quot;</span><span>,{btn:$(</span><span class="string">&quot;#btn&quot;</span><span>)},</span><span class="keyword">function</span><span>(evdata){&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span></font></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$.ajax({&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type:</span><font color="#000000"><span class="string">&quot;POST&quot;</span><span>,&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span></font></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataType:</span><font color="#000000"><span class="string">&quot;json&quot;</span><span>,&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span></font></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;url:</span><font color="#000000"><span class="string">&quot;data.php&quot;</span><span>,&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span></font></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;timeout:80000,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><font color="#000000"><span class="comment">//ajax请求超时时间80秒&nbsp;&nbsp;&nbsp;&nbsp; </span><span>&nbsp;</span></font></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data:{time:</span><font color="#000000"><span class="string">&quot;80&quot;</span><span>},&nbsp;</span><span class="comment">//40秒后无论结果服务器都返回数据&nbsp;&nbsp;&nbsp;&nbsp; </span><span>&nbsp;</span></font></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;success:</span><font color="#000000"><span class="keyword">function</span><span>(data,textStatus){&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span></font></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><font color="#000000"><span class="comment">//从服务器得到数据，显示数据并继续查询&nbsp;&nbsp;&nbsp;&nbsp; </span><span>&nbsp;</span></font></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><font color="#000000"><span class="keyword">if</span><span>(data.success==</span><span class="string">&quot;1&quot;</span><span>){&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span></font></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(</span><font color="#000000"><span class="string">&quot;#msg&quot;</span><span>).append(</span><span class="string">&quot;&lt;br&gt;[有数据]&quot;</span><span>+data.text);&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span></font></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;evdata.data.btn.click();&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><font color="#000000"><span class="comment">//未从服务器得到数据，继续查询&nbsp;&nbsp;&nbsp;&nbsp; </span><span>&nbsp;</span></font></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><font color="#000000"><span class="keyword">if</span><span>(data.success==</span><span class="string">&quot;0&quot;</span><span>){&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span></font></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(</span><font color="#000000"><span class="string">&quot;#msg&quot;</span><span>).append(</span><span class="string">&quot;&lt;br&gt;[无数据]&quot;</span><span>);&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span></font></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;evdata.data.btn.click();&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><font color="#000000"><span class="comment">//Ajax请求超时，继续查询&nbsp;&nbsp;&nbsp;&nbsp; </span><span>&nbsp;</span></font></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error:</span><font color="#000000"><span class="keyword">function</span><span>(XMLHttpRequest,textStatus,errorThrown){&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span></font></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><font color="#000000"><span class="keyword">if</span><span>(textStatus==</span><span class="string">&quot;timeout&quot;</span><span>){&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span></font></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(</span><font color="#000000"><span class="string">&quot;#msg&quot;</span><span>).append(</span><span class="string">&quot;&lt;br&gt;[超时]&quot;</span><span>);&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span></font></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;evdata.data.btn.click();&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;});&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span></li><li><span>});&nbsp;&nbsp;&nbsp;&nbsp;</span></li></ol></pre>
<p><strong>PHP</strong></p>
<p>在这里是无限的循环，循环的结束条件就是获取到了返回结果返回Json数据。</p>
<p>并且接受$_POST[&#39;time&#39;]参数来限制循环的超时时间，避免资源的过度浪费。(浏览器关闭不会发消息给服务器，使用可能一直循环下去)</p>
<pre>
<ol class="dp-c">
<li class="alt"><span><font color="#000000"><span class="keyword">if</span><span>(</span><span class="func">empty</span><span class="keyword">empty</span><span>(</span><span class="vars">$_POST</span><span>[</span><span class="string">&#39;time&#39;</span><span>]))</span><span class="func">exit</span><span>();&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span></font></span></li>
<li><span>set_time_limit(0);</span><font color="#000000"><span class="comment">//无限请求超时时间&nbsp;&nbsp;&nbsp;&nbsp; </span><span>&nbsp;</span></font></li>
<li class="alt&#038;# 	</div><!-- .entry-content -->	<footer class=">
		<span class="byline"><span class="author vcard"><img alt='' src='//2.gravatar.com/avatar/b9f7391bdaee9d0a30a3fda8ddd6436e?s=49&#038;d=mm&#038;r=g' srcset='//2.gravatar.com/avatar/b9f7391bdaee9d0a30a3fda8ddd6436e?s=98&amp;d=mm&amp;r=g 2x' class='avatar avatar-49 photo' height='49' width='49' /><span class="screen-reader-text">作者 </span> <a class="url fn n" href="/blog/author/lee">Lee</a></span></span><span class="posted-on"><span class="screen-reader-text">发布于 </span><a href="/blog/2012/223.html" rel="bookmark"><time class="entry-date published" datetime="2012-09-13T23:22:20+00:00">2012年9月13日</time><time class="updated" datetime="-001-11-30T00:00:00+00:00">-0001年11月30日</time></a></span><span class="cat-links"><span class="screen-reader-text">分类 </span><a href="/blog/category/web_development" rel="category tag">网站技术</a></span><span class="comments-link"><a href="/blog/2012/223.html#respond"><span class="screen-reader-text">于基于jQuery与PHP实现Ajax长轮询(LongPoll)</span>留下评论</a></span>			</footer><!-- .entry-footer -->
</article><!-- #post-## -->

<article id="post-221" class="post-221 post type-post status-publish format-standard hentry category-web_development">
	<header class="entry-header">
		
		<h2 class="entry-title"><a href="/blog/2012/221.html" rel="bookmark">代码之美 &#8211; 如何写出优雅的PHP代码</a></h2>	</header><!-- .entry-header -->

	
	
	<div class="entry-content">
		<p>　　写出优秀的程序代码是一门艺术，要想如此，就必须在一开始就养成良好的编程习惯。良好的编程习惯不仅有助于项目初期的设计（如模块化），还可以使你编写的代码更易于理解，从而使代码的维护工作更轻松、更省力。不好的编程习惯则会造成代码bug，并且会使以后的维护工作困难重重。&nbsp;</p>
<p>&nbsp;　　本文以PHP语言为例，介绍一些良好的编程习惯，希望能够对你有所帮助。&nbsp;</p>
<p>1.&nbsp;规划代码结构&nbsp;</p>
<p>　　优秀的PHP代码应该有清晰的结构。PHP面向对象的特性允许程序员将应用程序分解为函数或方法。如果代码晦涩难懂，你也可以添加注释，使代码的功能一目了然。编码时应尽量将前端代码（HTML/CSS/Javascript）与应用程序的服务端规则分开，或者你可以使用遵循MVC模式的PHP框架来构建你的应用程序。</p>
<p>2.&nbsp;编码风格统一&nbsp;</p>
<p>　　优秀的PHP代码应该具备统一的风格。比如，为变量和函数制定统一的命名规则，为循环任务（比如数据库存取、错误处理）制定统一的接入标准，或者保持有规律的代码缩进，这些编码习惯都可以让别人阅读代码更加轻松。&nbsp;</p>
<p>&nbsp;3.&nbsp;可移植性&nbsp;</p>
<p>　　优秀的PHP代码应该具有可移植性。程序员应学会运用PHP现有的特性（比如魔术引号和短标签等），应该了解产品需求，适应PHP的特点，保证写出的PHP代码具有可移植性和跨平台性。&nbsp;</p>
<p>&nbsp;4.&nbsp;代码安全性&nbsp;</p>
<p>　　优秀的PHP代码应该具有安全性。PHP5具有卓越的特性和灵活性，但应用程序的安全往往掌握在程序员的手中。作为专业的PHP开发人员，应该对安全漏洞有一些深入了解，常见的安全漏洞有跨站脚本攻击（XSS）、跨站请求伪造（CSRF）、代码注入漏洞和字符编码漏洞等。使用PHP中的特定功能和函数（比如mysql_real_escape_string等）可以帮助程序员写出安全的代码。&nbsp;</p>
<p>&nbsp;5.&nbsp;添加注释&nbsp;</p>
<p>　　代码注释是代码中的重要组成部分，它解释了函数运行的目的，这种注释会在代码以后的维护中提供非常有用的帮助。&nbsp;</p>
<p>&nbsp;6.&nbsp;避免简写标记&nbsp;</p>
<p>　　应使用完整的起始标记，不推荐使用简写的起始标记。&nbsp;</p>
<p>&nbsp;7.&nbsp;用单引号代替双引号&nbsp;</p>
<p>　　由于PHP会对双引号中的内容进行变量搜索，为了避免这种搜索带来的性能影响，程序员应该使用单引号引用字符串。&nbsp;</p>
<p>&nbsp;8.&nbsp;转义输出&nbsp;</p>
<p>　　应该在htmlspecialchars函数中使用ENT_QUOTES参数，保证单引号（&#39;）也可以被转义。尽管没有规定必须这样做，但这是一个好习惯。&nbsp;</p>
<p>&nbsp;9.&nbsp;使用逗号隔开字符串输出&nbsp;</p>
<p>　　字符串连接符（.）可以将单一的字符串传递给echo语句进行输出，与之相比，逗号可以实现echo语句中字符串的分别输出，这对PHP来说是一个性能改善。&nbsp;</p>
<p>&nbsp;10.&nbsp;在输出前检查传递值&nbsp;</p>
<p>　　应该记得在输出前检查$_GET[&#39;query&#39;]&nbsp;的传递值。使用isset函数或是empty函数可以检查变量值是否为空。</p>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		<span class="byline"><span class="author vcard"><img alt='' src='//2.gravatar.com/avatar/b9f7391bdaee9d0a30a3fda8ddd6436e?s=49&#038;d=mm&#038;r=g' srcset='//2.gravatar.com/avatar/b9f7391bdaee9d0a30a3fda8ddd6436e?s=98&amp;d=mm&amp;r=g 2x' class='avatar avatar-49 photo' height='49' width='49' /><span class="screen-reader-text">作者 </span> <a class="url fn n" href="/blog/author/lee">Lee</a></span></span><span class="posted-on"><span class="screen-reader-text">发布于 </span><a href="/blog/2012/221.html" rel="bookmark"><time class="entry-date published" datetime="2012-08-22T23:37:34+00:00">2012年8月22日</time><time class="updated" datetime="-001-11-30T00:00:00+00:00">-0001年11月30日</time></a></span><span class="cat-links"><span class="screen-reader-text">分类 </span><a href="/blog/category/web_development" rel="category tag">网站技术</a></span><span class="comments-link"><a href="/blog/2012/221.html#respond"><span class="screen-reader-text">于代码之美 &#8211; 如何写出优雅的PHP代码</span>留下评论</a></span>			</footer><!-- .entry-footer -->
</article><!-- #post-## -->

<article id="post-220" class="post-220 post type-post status-publish format-standard hentry category-web_development">
	<header class="entry-header">
		
		<h2 class="entry-title"><a href="/blog/2012/220.html" rel="bookmark">Apache日志配置详解</a></h2>	</header><!-- .entry-header -->

	
	
	<div class="entry-content">
		<p><strong>Apache日志按时间分段记录</strong></p>
<p>在apache的配置文件httpd.conf中找到<br />
ErrorLog logs/error_log及CustomLog logs/access_log common</p>
<p>Linux系统配置方法：<br />
将其改为<br />
ErrorLog &ldquo;| /usr/local/apache/bin/rotatelogs /home/logs/www/%Y_%m_%d_error_log 86400 480&Prime;<br />
CustomLog &ldquo;| /usr/local/apache/bin/rotatelogs /home/logs/www/%Y_%m_%d_access_log 86400 480&Prime; common</p>
<p>Windows系统下配置方法：<br />
ErrorLog &ldquo;|bin/rotatelogs.exe logs/site1/error-%y%m%d.log 86400 480&Prime;<br />
CustomLog &ldquo;|bin/rotatelogs.exe logs/site1/access-%y%m%d.log 86400 480&Prime; common</p>
<p>其中common为日志记录格式里设置的名称。<br />
若有多个站点，则应将以上配置写到各站点的VirtualHost节点中，这样才会分开文件记录各站点日志。</p>
<p>附rotatelogs说明</p>
<p>rotatelogs logfile [ rotationtime [ offset ]] | [ filesizeM ]</p>
<p>选项<br />
logfile<br />
它加上基准名就是日志文件名。如果logfile中包含&rsquo;%&rsquo;，则它会被视为用于的strftime(3)的格式字串；否则，它会被自动加上以秒为单位的.nnnnnnnnnn后缀。这两种格式都表示新的日志开始使用的时间。<br />
rotationtime<br />
日志文件回卷的以秒为单位的间隔时间，86400 表示一天，即每天生成一个新的日志文件。<br />
offset<br />
相对于UTC的时差的分钟数。如果省略，则默认为0，并使用UTC时间。比如，要指定UTC时差为-5小时的地区的当地时间，则此参数应为-300，北京时间为+8时间，应设置为480。这样日志里的时间才会和服务器上的时间一致，方便查看日志。<br />
filesizeM<br />
指定回卷时以兆字节为单位的后缀字母M的文件大小，而不是指定回卷时间或时差。<br />
&nbsp;</p>
<p><strong>apache日志记录格式的设置</strong></p>
<p>定制日志文件的格式涉及到两个指令，即LogFormat指令和CustomLog指令，默认httpd.conf文件提供了关于这两个指令的几个示例。</p>
<p>LogFormat指令定义格式并为格式指定一个名字，以后我们就可以直接引用这个名字。CustomLog指令设置日志文件，并指明日志文件所用的格式（通常通过格式的名字）。</p>
<p>LogFormat指令的功能是定义日志格式并为它指定一个名字。例如，在默认的httpd.conf文件中，我们可以找到下面这行代码：</p>
<p>LogFormat &quot;%h %l %u %t &quot;%r&quot; %&gt;s %b&quot;&nbsp;common<br />
该指令创建了一种名为&ldquo;common&rdquo;的日志格式，日志的格式在双引号包围的内容中指定。格式字符串中的每一个变量代表着一项特定的信息，这些信息按照格式串规定的次序写入到日志文件。</p>
<p>Apache文档已经给出了所有可用于格式串的变量及其含义，下面是其译文：<br />
%&hellip;a: 远程IP地址<br />
%&hellip;A: 本地IP地址<br />
%&hellip;B: 已发送的字节数，不包含HTTP头<br />
%&hellip;b: CLF格式的已发送字节数量，不包含HTTP头。例如当没有发送数据时，写入&lsquo;-&rsquo;而不是0。<br />
%&hellip;{FOOBAR}e: 环境变量FOOBAR的内容<br />
%&hellip;f: 文件名字<br />
%&hellip;h: 远程主机<br />
%&hellip;H 请求的协议<br />
%&hellip;{Foobar}i: Foobar的内容，发送给服务器的请求的标头行。<br />
%&hellip;l: 远程登录名字（来自identd，如提供的话）<br />
%&hellip;m 请求的方法<br />
%&hellip;{Foobar}n: 来自另外一个模块的注解&ldquo;Foobar&rdquo;的内容<br />
%&hellip;{Foobar}o: Foobar的内容，应答的标头行<br />
%&hellip;p: 服务器响应请求时使用的端口<br />
%&hellip;P: 响应请求的子进程ID。<br />
%&hellip;q 查询字符串（如果存在查询字符串，则包含&ldquo;?&rdquo;后面的部分；否则，它是一个空字符串。）<br />
%&hellip;r: 请求的第一行<br />
%&hellip;s: 状态。对于进行内部重定向的请求，这是指*原来*请求 的状态。如果用%&hellip;&gt;s，则是指后来的请求。<br />
%&hellip;t: 以公共日志时间格式表示的时间（或称为标准英文格式）<br />
%&hellip;{format}t: 以指定格式format表示的时间<br />
%&hellip;T: 为响应请求而耗费的时间，以秒计<br />
%&hellip;u: 远程用户（来自auth；如果返回状态（%s）是401则可能是伪造的）<br />
%&hellip;U: 用户所请求的URL路径<br />
%&hellip;v: 响应请求的服务器的ServerName<br />
%&hellip;V: 依照UseCanonicalName设置得到的服务器名字&nbsp;<br />
&nbsp;</p>
<p>在所有上面列出的变量中，&ldquo;&hellip;&rdquo;表示一个可选的条件。如果没有指定条件，则变量的值将以&ldquo;-&rdquo;取代。分析前面来自默认httpd.conf文件的 LogFormat指令示例，可以看出它创建了一种名为&ldquo;common&rdquo;的日志格式，其中包括：远程主机，远程登录名字，远程用户，请求时间，请求的第一 行代码，请求状态，以及发送的字节数。</p>
<p>有时候我们只想在日志中记录某些特定的、已定义的信息，这时就要用到&ldquo;&hellip;&rdquo;。如果在&ldquo;%&rdquo;和变量之间放入了一个或者多个HTTP状态代码，则只有当请 求返回的状态代码属于指定的状态代码之一时，变量所代表的内容才会被记录。例如，如果我们想要记录的是网站的所有无效链接，那么可以使用：<br />
LogFormat %404{Referer}i BrokenLinks</p>
<p>反之，如果我们想要记录那些状态代码不等于指定值的请求，只需加入一个&ldquo;!&rdquo;符号即可：</p>
<p>LogFormat %!200U SomethingWrong</p>
<p><strong>&nbsp;专门记录某个蜘蛛记录</strong></p>
<p>SetEnvIfNoCase User-Agent Baiduspider baidu_robot<br />
LogFormat &ldquo;%h %t &rdquo;%r&rdquo; %&gt;s %b&rdquo; robot<br />
linux下<br />
CustomLog &ldquo;|/usr/local/apache2.2.0/bin/rotatelogs /usr/local/apache2.2.0/logs/baidu_%Y%m%d.txt 86400 480&Prime; robot env=baidu_robot<br />
windows下<br />
CustomLog &ldquo;|bin/rotatelogs.exe logs/baidu_%Y%m%d.txt 86400 480&Prime; robot env=baidu_robot<br />
这样在logs目录下，就会每天产生baidu_年月日.txt的日志了，每条的记录和下面的类似：<br />
61.135.168.14 [22/Oct/2008:22:21:26 +0800] &ldquo;GET / HTTP/1.1&Prime; 200 8427</p>
<p><strong>去掉日志中的图片、js、css、swf文件</strong></p>
<p>&lt;FilesMatch&nbsp;&quot;.(ico|gif|jpg|png|bmp|swf|css|js)&quot;&gt;<br />
&nbsp;&nbsp;&nbsp;SetEnv&nbsp;IMAG&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&lt;/FilesMatch&gt;<br />
&nbsp;&nbsp;CustomLog&nbsp;&quot;|bin/cronolog.exe&nbsp;logs/cpseadmin/access_%Y%m%d.log&quot;&nbsp;combined&nbsp;env=!IMAG</p>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		<span class="byline"><span class="author vcard"><img alt='' src='//2.gravatar.com/avatar/b9f7391bdaee9d0a30a3fda8ddd6436e?s=49&#038;d=mm&#038;r=g' srcset='//2.gravatar.com/avatar/b9f7391bdaee9d0a30a3fda8ddd6436e?s=98&amp;d=mm&amp;r=g 2x' class='avatar avatar-49 photo' height='49' width='49' /><span class="screen-reader-text">作者 </span> <a class="url fn n" href="/blog/author/lee">Lee</a></span></span><span class="posted-on"><span class="screen-reader-text">发布于 </span><a href="/blog/2012/220.html" rel="bookmark"><time class="entry-date published" datetime="2012-08-14T21:26:40+00:00">2012年8月14日</time><time class="updated" datetime="2012-08-14T09:30:00+00:00">2012年8月14日</time></a></span><span class="cat-links"><span class="screen-reader-text">分类 </span><a href="/blog/category/web_development" rel="category tag">网站技术</a></span><span class="comments-link"><a href="/blog/2012/220.html#respond"><span class="screen-reader-text">于Apache日志配置详解</span>留下评论</a></span>			</footer><!-- .entry-footer -->
</article><!-- #post-## -->

<article id="post-219" class="post-219 post type-post status-publish format-standard hentry category-web_development">
	<header class="entry-header">
		
		<h2 class="entry-title"><a href="/blog/2012/219.html" rel="bookmark">PHP 获取文件 或 字符串的编码方式</a></h2>	</header><!-- .entry-header -->

	
	
	<div class="entry-content">
		<p>　　有时候从文本文档或者其它地方获取到字符串后由于编码的问题，输出的中文等文字会出现乱码，这时可以使用 mb_detect_encoding() 函数来判断字符串是什么编码的，然后用iconv函数转换成与页面一致的编码再输出字符串或者写入数据库。</p>
<p>注意：要把php.ini中 extension=php_mbstring.dll 前的;号去掉，重启apache就可以了。</p>
<p>代码如下：&nbsp;</p>
<div class="codeText">
<div class="codeHead">PHP代码</div>
<ol class="dp-c">
<li class="alt"><span><span>&lt;?php &nbsp;&nbsp;</span></span></li>
<li><span>define&nbsp;(</span><span class="string">&#39;UTF32_BIG_ENDIAN_BOM&#39;</span><span>&nbsp;&nbsp;&nbsp;,&nbsp;</span><span class="func">chr</span><span>(0x00)&nbsp;.&nbsp;</span><span class="func">chr</span><span>(0x00)&nbsp;.&nbsp;</span><span class="func">chr</span><span>(0xFE)&nbsp;.&nbsp;</span><span class="func">chr</span><span>(0xFF)); &nbsp;&nbsp;</span></li>
<li class="alt"><span>define&nbsp;(</span><span class="string">&#39;UTF32_LITTLE_ENDIAN_BOM&#39;</span><span>,&nbsp;</span><span class="func">chr</span><span>(0xFF)&nbsp;.&nbsp;</span><span class="func">chr</span><span>(0xFE)&nbsp;.&nbsp;</span><span class="func">chr</span><span>(0x00)&nbsp;.&nbsp;</span><span class="func">chr</span><span>(0x00)); &nbsp;&nbsp;</span></li>
<li><span>define&nbsp;(</span><span class="string">&#39;UTF16_BIG_ENDIAN_BOM&#39;</span><span>&nbsp;&nbsp;&nbsp;,&nbsp;</span><span class="func">chr</span><span>(0xFE)&nbsp;.&nbsp;</span><span class="func">chr</span><span>(0xFF)); &nbsp;&nbsp;</span></li>
<li class="alt"><span>define&nbsp;(</span><span class="string">&#39;UTF16_LITTLE_ENDIAN_BOM&#39;</span><span>,&nbsp;</span><span class="func">chr</span><span>(0xFF)&nbsp;.&nbsp;</span><span class="func">chr</span><span>(0xFE)); &nbsp;&nbsp;</span></li>
<li><span>define&nbsp;(</span><span class="string">&#39;UTF8_BOM&#39;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,&nbsp;</span><span class="func">chr</span><span>(0xEF)&nbsp;.&nbsp;</span><span class="func">chr</span><span>(0xBB)&nbsp;.&nbsp;</span><span class="func">chr</span><span>(0xBF)); &nbsp;&nbsp;</span></li>
<li class="alt"><span>&nbsp;&nbsp;</span></li>
<li><span class="keyword">function</span><span>&nbsp;detect_utf_encoding(</span><span class="vars">$text</span><span>)&nbsp;{ &nbsp;&nbsp;</span></li>
<li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="vars">$first2</span><span>&nbsp;=&nbsp;</span><span class="func">substr</span><span>(</span><span class="vars">$text</span><span>,&nbsp;0,&nbsp;2); &nbsp;&nbsp;</span></li>
<li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="vars">$first3</span><span>&nbsp;=&nbsp;</span><span class="func">substr</span><span>(</span><span class="vars">$text</span><span>,&nbsp;0,&nbsp;3); &nbsp;&nbsp;</span></li>
<li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="vars">$first4</span><span>&nbsp;=&nbsp;</span><span class="func">substr</span><span>(</span><span class="vars">$text</span><span>,&nbsp;0,&nbsp;3); &nbsp;&nbsp;</span></li>
<li><span>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>
<li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="vars">$first3</span><span>&nbsp;==&nbsp;UTF8_BOM)&nbsp;</span><span class="keyword">return</span><span>&nbsp;</span><span class="string">&#39;UTF-8&#39;</span><span>; &nbsp;&nbsp;</span></li>
<li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">elseif</span><span>&nbsp;(</span><span class="vars">$first4</span><span>&nbsp;==&nbsp;UTF32_BIG_ENDIAN_BOM)&nbsp;</span><span class="keyword">return</span><span>&nbsp;</span><span class="string">&#39;UTF-32BE&#39;</span><span>; &nbsp;&nbsp;</span></li>
<li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">elseif</span><span>&nbsp;(</span><span class="vars">$first4</span><span>&nbsp;==&nbsp;UTF32_LITTLE_ENDIAN_BOM)&nbsp;</span><span class="keyword">return</span><span>&nbsp;</span><span class="string">&#39;UTF-32LE&#39;</span><span>; &nbsp;&nbsp;</span></li>
<li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">elseif</span><span>&nbsp;(</span><span class="vars">$first2</span><span>&nbsp;==&nbsp;UTF16_BIG_ENDIAN_BOM)&nbsp;</span><span class="keyword">return</span><span>&nbsp;</span><span class="string">&#39;UTF-16BE&#39;</span><span>; &nbsp;&nbsp;</span></li>
<li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">elseif</span><span>&nbsp;(</span><span class="vars">$first2</span><span>&nbsp;==&nbsp;UTF16_LITTLE_ENDIAN_BOM)&nbsp;</span><span class="keyword">return</span><span>&nbsp;</span><span class="string">&#39;UTF-16LE&#39;</span><span>; &nbsp;&nbsp;</span></li>
<li><span>} &nbsp;&nbsp;</span></li>
<li class="alt"><span class="keyword">function</span><span>&nbsp;getFileEncoding(</span><span class="vars">$str</span><span>){ &nbsp;&nbsp;</span></li>
<li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="vars">$encoding</span><span>=mb_detect_encoding(</span><span class="vars">$str</span><span>); &nbsp;&nbsp;</span></li>
<li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>(</span><span class="func">empty</span><span class="keyword">empty</span><span>(</span><span class="vars">$encoding</span><span>)){ &nbsp;&nbsp;</span></li>
<li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="vars">$encoding</span><span>=detect_utf_encoding(</span><span class="vars">$str</span><span>); &nbsp;&nbsp;</span></li>
<li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</span></li>
<li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>&nbsp;</span><span class="vars">$encoding</span><span>; &nbsp;&nbsp;</span></li>
<li class="alt"><span>} &nbsp;&nbsp;</span></li>
<li><span class="vars">$file</span><span>&nbsp;=&nbsp;</span><span class="string">&#39;text1.txt&#39;</span><span>; &nbsp;&nbsp;</span></li>
<li class="alt"><span class="func">echo</span><span>&nbsp;getFileEncoding(</span><span class="func">file_get_contents</span><span>(</span><span class="vars">$file</span><span>));&nbsp;&nbsp;</span><span class="comment">//&nbsp;输出ASCII </span><span>&nbsp;&nbsp;</span></li>
<li><span class="func">echo</span><span>&nbsp;</span><span class="string">&#39;&lt;br&nbsp;/&gt;&#39;</span><span>; &nbsp;&nbsp;</span></li>
<li class="alt"><span>&nbsp;&nbsp;</span></li>
<li><span class="vars">$file</span><span>&nbsp;=&nbsp;</span><span class="string">&#39;text2.txt&#39;</span><span>; &nbsp;&nbsp;</span></li>
<li class="alt"><span class="func">echo</span><span>&nbsp;getFileEncoding(</span><span class="func">file_get_contents</span><span>(</span><span class="vars">$file</span><span>));&nbsp;&nbsp;</span><span class="comment">//&nbsp;输出UTF-8 </span><span>&nbsp;&nbsp;</span></li>
<li><span class="func">echo</span><span>&nbsp;</span><span class="string">&#39;&lt;br&nbsp;/&gt;&#39;</span><span>; &nbsp;&nbsp;</span></li>
<li class="alt"><span class="vars">$file</span><span>&nbsp;=&nbsp;</span><span class="string">&#39;text3.txt&#39;</span><span>; &nbsp;&nbsp;</span></li>
<li><span class="func">echo</span><span>&nbsp;getFileEncoding(</span><span class="func">file_get_contents</span><span>(</span><span class="vars">$file</span><span>));&nbsp;&nbsp;</span><span class="comment">//&nbsp;输出UTF-16LE </span><span>&nbsp;&nbsp;</span></li>
<li class="alt"><span class="func">echo</span><span>&nbsp;</span><span class="string">&#39;&lt;br&nbsp;/&gt;&#39;</span><span>; &nbsp;&nbsp;</span></li>
<li><span>?&gt; &nbsp;&nbsp;</span></li>
</ol>
</div>
<p>其中三个文件：text1.txt&nbsp;、text2.txt、text3.txt，分别以ASCII、UTF-8、UNICODE 的编码方式保存</p>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		<span class="byline"><span class="author vcard"><img alt='' src='//2.gravatar.com/avatar/b9f7391bdaee9d0a30a3fda8ddd6436e?s=49&#038;d=mm&#038;r=g' srcset='//2.gravatar.com/avatar/b9f7391bdaee9d0a30a3fda8ddd6436e?s=98&amp;d=mm&amp;r=g 2x' class='avatar avatar-49 photo' height='49' width='49' /><span class="screen-reader-text">作者 </span> <a class="url fn n" href="/blog/author/lee">Lee</a></span></span><span class="posted-on"><span class="screen-reader-text">发布于 </span><a href="/blog/2012/219.html" rel="bookmark"><time class="entry-date published" datetime="2012-07-19T19:39:44+00:00">2012年7月19日</time><time class="updated" datetime="2012-07-19T07:45:00+00:00">2012年7月19日</time></a></span><span class="cat-links"><span class="screen-reader-text">分类 </span><a href="/blog/category/web_development" rel="category tag">网站技术</a></span><span class="comments-link"><a href="/blog/2012/219.html#respond"><span class="screen-reader-text">于PHP 获取文件 或 字符串的编码方式</span>留下评论</a></span>			</footer><!-- .entry-footer -->
</article><!-- #post-## -->

<article id="post-218" class="post-218 post type-post status-publish format-standard hentry category-web_development">
	<header class="entry-header">
		
		<h2 class="entry-title"><a href="/blog/2012/218.html" rel="bookmark">PHP5.3的VC9、VC6、Thread Safe、Non Thread Safe的区别</a></h2>	</header><!-- .entry-header -->

	
	
	<div class="entry-content">
		<p>　　PHP 5.3.1一共有四个版本，VC9 x86 Non Thread Safe、VC9 x86 Thread Safe、VC6 x86 Non Thread Safe、VC6 x86 Thread Safe。</p>
<p>　　一、如何选择 PHP5.3 的 VC9 版本和 VC6 版本<br />
　　VC6 版本是使用 Visual Studio 6 编译器编译的，如果你的 PHP 是用 Apache 来架设的，那你就选择 VC6 版本。<br />
　　VC9 版本是使用 Visual Studio 2008 编译器编译的，如果你的 PHP 是用 IIS 来架设的，那你就选择 VC9 版本。<br />
　　二、如何选择 PHP5.3 的 Thread Safe 和 Non Thread Safe 版本<br />
　　先从字面意思上理解，Thread Safe 是线程安全，执行时会进行线程（Thread）安全检查，以防止有新要求就启动新线程的 CGI 执行方式而耗尽系统资源。Non Thread Safe 是非线程安全，在执行时不进行线程（Thread）安全检查。<br />
　　再来看 PHP 的两种执行方式：ISAPI 和 FastCGI。<br />
　　ISAPI 执行方式是以 DLL 动态库的形式使用，可以在被用户请求后执行，在处理完一个用户请求后不会马上消失，所以需要进行线程安全检查，这样来提高程序的执行效率，所以如果是以 ISAPI 来执行 PHP，建议选择 Thread Safe 版本；<br />
　　而 FastCGI 执行方式是以单一线程来执行操作，所以不需要进行线程的安全检查，除去线程安全检查的防护反而可以提高执行效率，所以，如果是以 FastCGI 来执行 PHP，建议选择 Non Thread Safe 版本。<br />
　　官方并不建议你将Non Thread Safe 应用于生产环境，所以我们选择Thread Safe 版本的PHP来使用。<br />
&nbsp;</p>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		<span class="byline"><span class="author vcard"><img alt='' src='//2.gravatar.com/avatar/b9f7391bdaee9d0a30a3fda8ddd6436e?s=49&#038;d=mm&#038;r=g' srcset='//2.gravatar.com/avatar/b9f7391bdaee9d0a30a3fda8ddd6436e?s=98&amp;d=mm&amp;r=g 2x' class='avatar avatar-49 photo' height='49' width='49' /><span class="screen-reader-text">作者 </span> <a class="url fn n" href="/blog/author/lee">Lee</a></span></span><span class="posted-on"><span class="screen-reader-text">发布于 </span><a href="/blog/2012/218.html" rel="bookmark"><time class="entry-date published" datetime="2012-07-17T01:27:47+00:00">2012年7月17日</time><time class="updated" datetime="-001-11-30T00:00:00+00:00">-0001年11月30日</time></a></span><span class="cat-links"><span class="screen-reader-text">分类 </span><a href="/blog/category/web_development" rel="category tag">网站技术</a></span><span class="comments-link"><a href="/blog/2012/218.html#respond"><span class="screen-reader-text">于PHP5.3的VC9、VC6、Thread Safe、Non Thread Safe的区别</span>留下评论</a></span>			</footer><!-- .entry-footer -->
</article><!-- #post-## -->

<article id="post-214" class="post-214 post type-post status-publish format-standard hentry category-web_development">
	<header class="entry-header">
		
		<h2 class="entry-title"><a href="/blog/2012/214.html" rel="bookmark">新网站SEO优化要避开的五个雷区</a></h2>	</header><!-- .entry-header -->

	
	
	<div class="entry-content">
		<p>　　利用搜索引擎在互联网上查找信息早已成为人们获取信息的最主要方式，伴随着搜索引擎技术的不断进步，网站要被搜索引擎收录更多和获取更好排名的难度越来越大。作为网站优化人员，必须要熟悉搜索引擎的特点，尽量避免使用对搜索引擎不友好的优化方式，以获得搜索引擎的青睐。</p>
<p>新站优化雷区一：网站标题和版式经常改动</p>
<p>对于新站来说，网站的权重很低甚至还在搜索引擎的考察期。如果这个时间对网站标题和版式频繁改动，会使得搜索引擎认为你的网站还没有完成，那么搜索引擎需要重新认识你的网站，就还需要重新审核和验证，甚至会降权一段时间才会慢慢被认可。一般来说现在百度对新站的考察期大体在2-4个星期，这个时间里尽量不要动标题和版式。</p>
<p>新站优化雷区二：采集转载内容过多</p>
<p>采集和转载内容过多不利于网站权重的提升，说到底搜索引擎其实还是喜欢新鲜事物，也就是我们通常所说的&ldquo;原创&rdquo;。现在很多站长利用软件采集更新网站并不是长久之计，这种采集来的文字即使被收录，对增加网站权重也没什么帮助，而且过段时间就会被清除掉。所以，还是那句话，&ldquo;原创才是王道&rdquo;。</p>
<p>新站优化雷区三：短时间内外链大量增长</p>
<p>都知道外链的重要性，那是不是外链越多越好呢？不一定。外部链接的建设是需要技巧的，新站和老站在外链建设问题上要区别对待，新站在建设初期因为权重不高，外链也不宜过多，而且要循序渐进。在搜索引擎的眼里，一个新站是不可能在短时间内获得很多的外部链接的，短时间内外链大量增长很可能会被搜索引擎认为是在作弊。等到网站收录稳定以后，外部链接每天增加的数量和频率也尽量要保持一致。</p>
<p>新站优化雷区四：关键词密度过大或存在不相关的关键词</p>
<p>关于关键词的密度，经过众多站长们的研究分析发现网站关键词的密度控制在2%~8%是最合理的，也是搜索引擎最能接受的。关键词的密度并不是越大越好，是自然最好，即恰当地表达，使行文流畅。再者，有些站长为了吸引流量，故意在网页中布置一些社会热门关键词，而这些关键词与网页内容其实是没有关系的，这样的情况也会被搜索引擎认为是在作弊。比如你的网站明明是手机类的网站，却突然出现很多&ldquo;金正日逝世&rdquo;的新闻，这明显是不搭调的。所以，在关键词这里要掌握密度不要过大，同时不要大量存在于网站内容不相关的关键词。</p>
<p>新站优化雷区五：网页中有隐藏信息</p>
<p>网页中有用户看不见但搜索引擎能识别的内容，这些内容主要是隐藏的文字或者链接，在SEO中这属于&ldquo;黑帽&rdquo;。其实无论你是使用什么样的方法，比如使用和背景色相同的文字、隐藏的文字、超小号的文字还是滥用图片，都会被搜索引擎认为是作弊的行为，一旦认定你的网站在作弊，举例被降权也就不远了。</p>
<p>综上所述，做网站优化还是要踏踏实实的，不要急功近利，多考虑些用户体验，多做对用户有实际价值的内容，这样的网站才能有持久的生命力。</p>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		<span class="byline"><span class="author vcard"><img alt='' src='//2.gravatar.com/avatar/b9f7391bdaee9d0a30a3fda8ddd6436e?s=49&#038;d=mm&#038;r=g' srcset='//2.gravatar.com/avatar/b9f7391bdaee9d0a30a3fda8ddd6436e?s=98&amp;d=mm&amp;r=g 2x' class='avatar avatar-49 photo' height='49' width='49' /><span class="screen-reader-text">作者 </span> <a class="url fn n" href="/blog/author/lee">Lee</a></span></span><span class="posted-on"><span class="screen-reader-text">发布于 </span><a href="/blog/2012/214.html" rel="bookmark"><time class="entry-date published" datetime="2012-06-14T10:05:42+00:00">2012年6月14日</time><time class="updated" datetime="2012-06-20T11:52:00+00:00">2012年6月20日</time></a></span><span class="cat-links"><span class="screen-reader-text">分类 </span><a href="/blog/category/web_development" rel="category tag">网站技术</a></span><span class="comments-link"><a href="/blog/2012/214.html#respond"><span class="screen-reader-text">于新网站SEO优化要避开的五个雷区</span>留下评论</a></span>			</footer><!-- .entry-footer -->
</article><!-- #post-## -->

<article id="post-211" class="post-211 post type-post status-publish format-standard hentry category-web_development">
	<header class="entry-header">
		
		<h2 class="entry-title"><a href="/blog/2012/211.html" rel="bookmark">使用Namecheap FreeDNS免费的DNS解析服务教程</a></h2>	</header><!-- .entry-header -->

	
	
	<div class="entry-content">
		<p>　　由于需要URL转发等一些国内域名服务商不提供的域名解析服务，就需要寻找第三方的域名解析服务（即DNS服务）。经过查找与试用，我觉得Namecheap FreeDNS服务比较不错，免费且功能齐全，解析速度也挺快的。由于Namecheap的网站是英文的，可能有些朋友不知道如何使用，现将使用教程简单地写一下，供需要的朋友参考。</p>
<p>　　先到<a href="https://www.namecheap.com/myaccount/signup.aspx">https://www.namecheap.com/myaccount/signup.aspx</a>注册一个账号，填写项目有：Username（用户名）、Password（密码）、Confirm Password（确认密码）、First Name（名）、Last Name（姓）和Email。填写完毕后点击Create Account 按钮即可注册完成。</p>
<p>　　登录账号（在页面顶部导航栏上方有登录框）后点击菜单PRODUCTS下的Free DNS或者直接访问<a href="https://www.namecheap.com/products/freedns.aspx">https://www.namecheap.com/products/freedns.aspx</a>，输入要使用免费 DNS 服务的域名（不带www，如：biglee.cn）</p>
<p>
<img alt="" src="http://www.biglee.cn/blog/download.asp?id=1" /></p>
<p>　　然后点 Get DNS 按钮，之后就会进入一个确认页面，检查域名无误后点击&ldquo;Add DNS Service for Selected Domains&rdquo;按钮，不出意外的话就会提示你添加成功，并且给出了你将要设置的DNS服务器的域名（freedns1.registrar-servers.com、freedns2.registrar-servers.com、freedns3.registrar-servers.com、freedns4.registrar-servers.com、freedns5.registrar-servers.com）。点击OK! Go to the Hosted Domains Page进入域名管理页面，就能看到你添加的域名。</p>
<p>　　点击域名进入解析设置页面。如果尚未修改域名的DNS服务器记录，这里会显示无效：<b>Current DNS Status: </b><span style="background-color: yellow;">INACTIVE</span>，并提醒你修改DNS服务器。为了使域名快速生效，还要进行邮箱验证，点击select authorization email，会弹出一个窗口，上面有几个该域名下的邮箱地址（排在左侧）及从Whois信息里获取到的域名所有人邮箱地址（列在右侧），可以选择一个你能收到信的邮箱地址。如果无法从Whois信息里获取邮箱地址信息且你的域名还未建有相关邮箱，那只能等建立好邮箱（不知能否用Namecheap FreeDNS里的邮件转发功能来收信，未做测试，测试过的朋友烦请告知，谢谢）后再验证。</p>
<p>　　域名解析设置非常地简单，填写好 	  HOST NAME（即主机头名或者二级域名，空主机头和www主机头两条记录它已经单独列出来），在 	  IP ADDRESS/ URL这栏填写好IP地址或者别名，同时选择记录类型（RECORD TYPE），然后点Save Changes按钮保存。如果有好多二级域名记录，一次写不下的话，你保存完后会自动新增5个空白记录。</p>
<p>　　Email的MX记录设置有个地方要注意，一般我们都是用的企业邮箱，勾选第三项&nbsp;User中的第一项I will specify my own MX records（如果用的Google企业邮箱套件请选第三项，会自动配置），保存后才会出现MX记录填写框，填写好相关数据，保存即可。</p>
<p>　　特别提醒：如果你的域名正在使用中，那么为了无缝转移解析，要先在Namecheap FreeDNS里做好相关解析再改你域名的DNS服务器记录。</p>
<p>　　已经添加的域名，登录管理的路径为：菜单MY ACCOUNT<span class="loggedin managesite">&gt;  			Manage Domains，点击左侧导航的FreeDNS下的<span class="loggedin managesite">Hosted Domains就能进入域名管理列表。</span></span></p>
<p><span class="loggedin managesite"><span class="loggedin managesite">　　另，这里还有动态域名解析服务（Dynamic DNS），我还没试用，等有机会试用了再写个教程。</span></span></p>
<p>　　</p>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		<span class="byline"><span class="author vcard"><img alt='' src='//2.gravatar.com/avatar/b9f7391bdaee9d0a30a3fda8ddd6436e?s=49&#038;d=mm&#038;r=g' srcset='//2.gravatar.com/avatar/b9f7391bdaee9d0a30a3fda8ddd6436e?s=98&amp;d=mm&amp;r=g 2x' class='avatar avatar-49 photo' height='49' width='49' /><span class="screen-reader-text">作者 </span> <a class="url fn n" href="/blog/author/lee">Lee</a></span></span><span class="posted-on"><span class="screen-reader-text">发布于 </span><a href="/blog/2012/211.html" rel="bookmark"><time class="entry-date published" datetime="2012-05-28T21:06:37+00:00">2012年5月28日</time><time class="updated" datetime="2012-05-29T01:40:00+00:00">2012年5月29日</time></a></span><span class="cat-links"><span class="screen-reader-text">分类 </span><a href="/blog/category/web_development" rel="category tag">网站技术</a></span><span class="comments-link"><a href="/blog/2012/211.html#respond"><span class="screen-reader-text">于使用Namecheap FreeDNS免费的DNS解析服务教程</span>留下评论</a></span>			</footer><!-- .entry-footer -->
</article><!-- #post-## -->

<article id="post-210" class="post-210 post type-post status-publish format-standard hentry category-web_development">
	<header class="entry-header">
		
		<h2 class="entry-title"><a href="/blog/2012/210.html" rel="bookmark">pjblog升级到3.2.9.518后友情链接页面无数据的解决方法</a></h2>	</header><!-- .entry-header -->

	
	
	<div class="entry-content">
		<p>　　前不久得空将博客程序升级到了V3.2.9.518版，今天和一网友交换友情链接时发现友情链接的更多页面里所有友情链接都消失了，只剩下一个友情链接申请提交表单。</p>
<p>　　正好有点时间，于是分析了下程序和数据库，找到了问题的所在。</p>
<p>　　先看BlogLink.asp的51行：server.Execute(&quot;post/link.html&quot;)，查看post/link.html文件，发现内容为空，这是直接原因。</p>
<p>　　再看生成post/link.html文件的程序代码，是control/f_control.asp里的258行开始的这个Sub PostLink()。对应数据库表结构，可知这个代码是先读取友情链接分类，然后再按分类读取友情链接信息，然而我发现友情链接表里的分类ID都为0，也就是未分类，因此程序最终没有读取到任何信息。</p>
<p>　　解决办法有两个，一个就是去后台将所有的友情链接分类。这是最简单的方法。</p>
<p>　　还有一个办法就是修改程序，将未分类的友情链接也读取出来。之前一直未注意，不知道上一个版本有没有这样的问题，有的话也是类似的修改方法。附修改后的Sub PostLink()代码如下：</p>
<p>Sub PostLink()<br />
&nbsp;&nbsp;&nbsp;&nbsp; Dim LoadTemplate, Temp, SaveArticle<br />
&nbsp; Dim Link_SplitArray, Link_Global_Temp, Link_Layout_Temp, LinkClassTemp, LinkTemp, AllTemp<br />
&nbsp;&nbsp;&nbsp;&nbsp; LoadTemplate = LoadFromFile(&quot;Template/Link.asp&quot;)<br />
&nbsp;&nbsp;&nbsp;&nbsp; If LoadTemplate(0) = 0 Then &#39;读取成功后写入信息<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Temp = LoadTemplate(1)<br />
&nbsp;&nbsp; Link_SplitArray = Split(Temp, &quot;&lt;#ST(B)#&gt;&quot;)<br />
&nbsp;&nbsp; Link_Global_Temp = Link_SplitArray(1)<br />
&nbsp;&nbsp; Link_Layout_Temp = Link_SplitArray(2)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim blog_Links<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set blog_Links = conn.Execute(&quot;Select * From blog_LinkClass order by LinkClass_Order asc&quot;)<br />
&nbsp;&nbsp; AllTemp = &quot;&quot;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Do Until blog_Links.EOF<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LinkClassTemp = Link_Global_Temp<br />
&nbsp;&nbsp;&nbsp; LinkTemp = Link_Layout_Temp<br />
&nbsp;&nbsp;&nbsp; Dim LinkSingContent<br />
&nbsp;&nbsp;&nbsp; LinkSingContent = GetLinkSingleHtml(LinkTemp, Trim(blog_Links(&quot;LinkClass_ID&quot;)), 3)<br />
&nbsp;&nbsp;&nbsp; If Len(LinkSingContent) &gt; 0 Then<br />
&nbsp;&nbsp;&nbsp;&nbsp; LinkClassTemp = Replace(LinkClassTemp, &quot;&lt;$LinkClass_Name$&gt;&quot;, Trim(blog_Links(&quot;LinkClass_Name&quot;)))<br />
&nbsp;&nbsp;&nbsp;&nbsp; LinkClassTemp = Replace(LinkClassTemp, &quot;&lt;$LinkClass_Title$&gt;&quot;, Trim(blog_Links(&quot;LinkClass_Title&quot;)))<br />
&nbsp;&nbsp;&nbsp;&nbsp; LinkClassTemp = Replace(LinkClassTemp, &quot;&lt;$LoopLayout$&gt;&quot;, LinkSingContent)<br />
&nbsp;&nbsp;&nbsp;&nbsp; AllTemp = AllTemp &amp; LinkClassTemp<br />
&nbsp;&nbsp;&nbsp; End If<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; blog_Links.movenext<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Loop<br />
&nbsp;&nbsp; LinkClassTemp = Link_Global_Temp<br />
&nbsp;&nbsp; LinkTemp = Link_Layout_Temp<br />
&nbsp;&nbsp; LinkSingContent = GetLinkSingleHtml(LinkTemp, 0, 3)<br />
&nbsp;&nbsp; If Len(LinkSingContent) &gt; 0 Then<br />
&nbsp;&nbsp;&nbsp; LinkClassTemp = Replace(LinkClassTemp, &quot;&lt;$LinkClass_Name$&gt;&quot;, &quot;其它&quot;)<br />
&nbsp;&nbsp;&nbsp; LinkClassTemp = Replace(LinkClassTemp, &quot;&lt;$LinkClass_Title$&gt;&quot;, &quot;Orther&quot;)<br />
&nbsp;&nbsp;&nbsp; LinkClassTemp = Replace(LinkClassTemp, &quot;&lt;$LoopLayout$&gt;&quot;, LinkSingContent)<br />
&nbsp;&nbsp;&nbsp; AllTemp = AllTemp &amp; LinkClassTemp<br />
&nbsp;&nbsp; End If<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SaveArticle = SaveToFile(AllTemp, &quot;post/link.html&quot;)<br />
&nbsp;&nbsp;&nbsp;&nbsp; End If<br />
&nbsp;End Sub</p>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		<span class="byline"><span class="author vcard"><img alt='' src='//2.gravatar.com/avatar/b9f7391bdaee9d0a30a3fda8ddd6436e?s=49&#038;d=mm&#038;r=g' srcset='//2.gravatar.com/avatar/b9f7391bdaee9d0a30a3fda8ddd6436e?s=98&amp;d=mm&amp;r=g 2x' class='avatar avatar-49 photo' height='49' width='49' /><span class="screen-reader-text">作者 </span> <a class="url fn n" href="/blog/author/lee">Lee</a></span></span><span class="posted-on"><span class="screen-reader-text">发布于 </span><a href="/blog/2012/210.html" rel="bookmark"><time class="entry-date published" datetime="2012-05-18T22:01:17+00:00">2012年5月18日</time><time class="updated" datetime="2012-05-19T01:19:00+00:00">2012年5月19日</time></a></span><span class="cat-links"><span class="screen-reader-text">分类 </span><a href="/blog/category/web_development" rel="category tag">网站技术</a></span><span class="comments-link"><a href="/blog/2012/210.html#respond"><span class="screen-reader-text">于pjblog升级到3.2.9.518后友情链接页面无数据的解决方法</span>留下评论</a></span>			</footer><!-- .entry-footer -->
</article><!-- #post-## -->

<article id="post-204" class="post-204 post type-post status-publish format-standard hentry category-web_development">
	<header class="entry-header">
		
		<h2 class="entry-title"><a href="/blog/2012/204.html" rel="bookmark">发送邮件提示“551 User not local; please try ”错误的原因及解决办法</a></h2>	</header><!-- .entry-header -->

	
	
	<div class="entry-content">
		<p>　　一网站要嵌入一个客户反馈系统。为了方便收集反馈信息，并能及时查看信息，我决定以将反馈内容提交到邮箱。<br />
　　用了一个之前收集的<a target="_blank" href="https://www.biglee.cn/blog/2012/205.html">PHP写的SMTP发邮件类函数</a>，很快就搞定了，本地测试正常。传到服务器后发现收不到信，看了下函数，发现有Debug功能，开启Debug，反馈的信息如下：</p>
<blockquote>
<p>&nbsp;eG15Ym94MTQ3ODk2MzI1 235 Authentication successful &gt;;<br />
&nbsp;MAIL FROM:; 250 Ok &gt;;<br />
&nbsp;RCPT TO:; 551 User not local; please try Error: Remote host returned &quot;551 User not local; <br />
&nbsp;please try &quot; Error: Error occurred while sending RCPT TO command. Error: Cannot send email to ;<br />
&nbsp;Disconnected from remote host</p>
</blockquote>
<p>　　查了些资料，说出现以上错误信息的原因和所发邮件有没有内容、内容大小等都没有关系，是中国政府的国家防火墙(GFW，又名&ldquo;金盾工程&rdquo;)做了过滤的原因，它（金盾工程）定义了大陆的IP连接到大陆以外（如香港、台湾、欧洲等）的邮件服务器是不可以自己发邮件给自己的！</p>
<p>　　相反的，我是用PHP写的发送邮件程序，在海外主机上用腾讯企业邮箱的SMTP发送邮件。看来也是被墙了。再仔细看了下上面那个解释，我注意到&ldquo;不可以自己发邮件给自己&rdquo;，正好我为了方便，就是用自己和邮箱账号发给自己的邮箱来收集反馈信息，那我就换个用户来发送试试看，登录腾讯企业邮箱管理，新建了一个专门发送邮件的邮箱账号，再上传测试，成功了。</p>
<p>　　问题是解决了，但是我不明白的是，为什么自己邮箱给自己的邮箱发送就被阻止了，而发给同个服务器同个域下的另一个账号就没问题呢？不知道是出于什么目的。。。。</p>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		<span class="byline"><span class="author vcard"><img alt='' src='//2.gravatar.com/avatar/b9f7391bdaee9d0a30a3fda8ddd6436e?s=49&#038;d=mm&#038;r=g' srcset='//2.gravatar.com/avatar/b9f7391bdaee9d0a30a3fda8ddd6436e?s=98&amp;d=mm&amp;r=g 2x' class='avatar avatar-49 photo' height='49' width='49' /><span class="screen-reader-text">作者 </span> <a class="url fn n" href="/blog/author/lee">Lee</a></span></span><span class="posted-on"><span class="screen-reader-text">发布于 </span><a href="/blog/2012/204.html" rel="bookmark"><time class="entry-date published" datetime="2012-04-18T11:17:14+00:00">2012年4月18日</time><time class="updated" datetime="2012-04-26T01:29:00+00:00">2012年4月26日</time></a></span><span class="cat-links"><span class="screen-reader-text">分类 </span><a href="/blog/category/web_development" rel="category tag">网站技术</a></span><span class="comments-link"><a href="/blog/2012/204.html#comments"><span class="screen-reader-text">发送邮件提示“551 User not local; please try ”错误的原因及解决办法</span>有1条评论</a></span>			</footer><!-- .entry-footer -->
</article><!-- #post-## -->

<article id="post-202" class="post-202 post type-post status-publish format-standard hentry category-web_development">
	<header class="entry-header">
		
		<h2 class="entry-title"><a href="/blog/2012/202.html" rel="bookmark">成就PHP高手的五个必由之路</a></h2>	</header><!-- .entry-header -->

	
	
	<div class="entry-content">
		<p>原文名称： 5 ways to be a better php developer<br />
原文链接： [url]http://www.developertutorials.com/blog/web/5-ways-to-be-a-better-php-developer-36/ [/url]英文版原文已经摘抄在本文后面，供参考。<br />
中文翻译： Altair</p>
<p>　　经常有一些经验不足的PHP开发人员在Freenode的##php IRC频道上问问题。如果问题很琐碎，或者答案显而易见，或表现得象一个菜鸟，很快他们就会发现会受到如下一些回复的炮轰：“去读该死的手册去吧”，“好好去学一学PHP吧”，“我们不是你个人的导师”或更直接的“你需要成为一个更好的PHP开发者”。但是，怎样才能成为一个更优秀的PHP开发者呢？在这篇文章中，我列出了五种成为更优秀的PHP开发者的方法，让你在PHP开发过程中提高效率，用更少的代码来完成更多的事情。在PHP的开发过程中永远会有更多的内容需要去学习,如新的核心函数，新的框架，新的设计模式，新的编码或文档规范等等。下面就是一些成为更优秀的PHP开发者的最佳途径。</p>
<p>1.阅读手册</p>
<p>　　没什么比阅读手册更值得强调的事了–仅仅通过阅读手册你就可以学习到很多东西。特别是有关字符串和数组有关的函数。就在这些函数里面包括许多有用的功能，如果你仔细阅读手册，你会经常发现在以往的项目开发过程中，很多时候你在“重复发明轮子”，而实际上你只需要一个核心函数就可以完成相应的功能。手册是你的朋友。</p>
<p>2.阅读程序源代码</p>
<p>　　有很多使用PHP开发的开源程序。为什么不去学习和借鉴呢？下载一份开源的PHP应用程序的源代码，仔细阅读它吧。也许越大的项目越值得去阅读，虽然它们也许有更复杂的结构和系统，但也有更详细的解释文档。如果你不知道从哪里开始，可以看看网站 http://www.sourceforge.net 。</p>
<p>3.学习一种框架</p>
<p>　　现在的框架如雨后春笋般纷纷出笼;它们中的大部分都是开源的，可以直接从网上下载，当然你要知道从哪里去下载。可以先选择一些主流的框架 — 网站[url]http://www.phpframeworks.com[/url]里有一个非常好的主流框架的列表。</p>
<p>4.研究</p>
<p>　　在PHP网站开发过程和讨论中你可能听说过很多术语。从OOP到MVC,KISS到DRY,YAML到INI,甚至REST到XML-RPC，也许有数百个与你的工作直接相关的技术概念。你也许对它们有了一个基本的了解，但你真的了解它们到底是什么，对你有什么意义吗？花一点时间去做些实实在在的研究吧。Wikipedia是从事这些研究的很好的起点。你一定会从中学到一些新知识的。</p>
<p>5.学习面向对象程序设计</p>
<p>　　这也许是上一个方法的继续，但是OOP比你想象的更重要。你真的了解PHP5中OOP是如何实现的吗？例如，你真的了解抽象类，接口，“implements”关键字，静态方法和静态属性，访问修饰符“protected”吗？甚至许多有经验的开发人员都倒在这些问题的面前。如果你能充分利用OOP的特征，你就可以节省很多的开发时间。</p>
<p>　　就是这些。要想成为 PHP 高手，这是五个最直接而又重要的的方法</p>
<p>附英文原文：<br />
5 Ways to be a Better PHP Developer<br />
Often, an inexperienced PHP developer will hop onto IRC and ask a question in ##php on Freenode. And if the question is trivial, the answer seems obvious o&#114; they simply seem like a newbie, they may soon find themselves bombarded with such comments as “RTFM”, “Go learn PHP”, “We are not your personal tutors” o&#114; simply “You need to become a better PHP developer”. So, how is it that one becomes a better PHP developer? In this post, I’ll outline five ways to be a better developer, improve your productivity, write less code and achieve more with your web applications.There’s always more to learn when it comes to PHP development. New core functions, new frameworks, new design patterns, new code documentation styles. Here are some of the best ways you can become a better PHP developer.</p>
<p>1. Read the manual<br />
I really can’t emphasize this enough – there’s a lot to be learned just reading the PHP manual. Especially check out the string and array functions. There’s a lot of functionality available right there, and often by reading through the manual you’ll find you’ve been reinventing the wheel in past projects when you could have just used a core function. The manual is your friend.</p>
<p>2. Browse through some code<br />
PHP has a lot of open source code out there. So why not learn from it? Download an open source PHP application and have a read through the code. The bigger projects are probably better, as they’ll have more complex structures and systems in place but also more thorough documentation explaining it all. Check out SourceForge.net if you can’t find a good place to start.</p>
<p>3. Learn a new framework<br />
There are more PHP frameworks out there than you’ve had hot dinners; a lot of them are open source and available online if you know wh&#101;re to look. Try the major ones first – phpframeworks.com has a good list. Your framework can never be entirely complete, your next job may require a different framework and you might just find the functionality of another comes in handy in one of your projects.</p>
<p>4. Research<br />
You’ve probably heard a lot of terminology and discussed in the context of PHP web development. From OOP to MVC, KISS to DRY, YAML to INI, even REST to XML-RPC, there are hundreds of technical concepts out there that could directly relate to your work. You may have formed a basic understanding of them, but do you really know what they are o&#114; what they mean for you? Spend some time doing real research; Wikipedia is a good place to start. You’re bound to learn something new.</p>
<p>5. Learn OOP<br />
Maybe this follows on a little from the previous point, but OOP is more important than you think. Do you really know about PHP5′s implementation OOP? For example, are you familiar with abstract classes, interfaces, the implements keyword, static methods and properties, the ‘protected’ access modifier? Even many experienced PHP developers fall down in this area. If you make use of the features of OOP, you could save yourself a lot of development time.</p>
<p>So there you have it. Five, straightforward yet significant ways to be a better PHP developer.</p>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		<span class="byline"><span class="author vcard"><img alt='' src='//2.gravatar.com/avatar/b9f7391bdaee9d0a30a3fda8ddd6436e?s=49&#038;d=mm&#038;r=g' srcset='//2.gravatar.com/avatar/b9f7391bdaee9d0a30a3fda8ddd6436e?s=98&amp;d=mm&amp;r=g 2x' class='avatar avatar-49 photo' height='49' width='49' /><span class="screen-reader-text">作者 </span> <a class="url fn n" href="/blog/author/lee">Lee</a></span></span><span class="posted-on"><span class="screen-reader-text">发布于 </span><a href="/blog/2012/202.html" rel="bookmark"><time class="entry-date published" datetime="2012-03-31T13:40:47+00:00">2012年3月31日</time><time class="updated" datetime="2012-03-31T01:41:00+00:00">2012年3月31日</time></a></span><span class="cat-links"><span class="screen-reader-text">分类 </span><a href="/blog/category/web_development" rel="category tag">网站技术</a></span><span class="comments-link"><a href="/blog/2012/202.html#respond"><span class="screen-reader-text">于成就PHP高手的五个必由之路</span>留下评论</a></span>			</footer><!-- .entry-footer -->
</article><!-- #post-## -->

	<nav class="navigation pagination" role="navigation">
		<h2 class="screen-reader-text">文章导航</h2>
		<div class="nav-links"><a class="prev page-numbers" href="/blog/category/web_development/page/5">上一页</a>
<a class='page-numbers' href='/blog/category/web_development'><span class="meta-nav screen-reader-text">页 </span>1</a>
<span class="page-numbers dots">&hellip;</span>
<a class='page-numbers' href='/blog/category/web_development/page/5'><span class="meta-nav screen-reader-text">页 </span>5</a>
<span class='page-numbers current'><span class="meta-nav screen-reader-text">页 </span>6</span>
<a class='page-numbers' href='/blog/category/web_development/page/7'><span class="meta-nav screen-reader-text">页 </span>7</a>
<span class="page-numbers dots">&hellip;</span>
<a class='page-numbers' href='/blog/category/web_development/page/14'><span class="meta-nav screen-reader-text">页 </span>14</a>
<a class="next page-numbers" href="/blog/category/web_development/page/7">下一页</a></div>
	</nav>
		</main><!-- .site-main -->
	</div><!-- .content-area -->


	<aside id="secondary" class="sidebar widget-area" role="complementary">
		<section id="search-2" class="widget widget_search">
<form role="search" method="get" class="search-form" action="/">
	<label>
		<span class="screen-reader-text">搜索：</span>
		<input type="search" class="search-field" placeholder="搜索…" value="" name="s" />
	</label>
	<button type="submit" class="search-submit"><span class="screen-reader-text">搜索</span></button>
</form>
</section>		<section id="recent-posts-2" class="widget widget_recent_entries">		<h2 class="widget-title">近期文章</h2>		<ul>
					<li>
				<a href="/blog/2016/307.html">curl与file_get_contents访问远程接口慢的解决</a>
						</li>
					<li>
				<a href="/blog/2016/306.html">PHP中Notice: iconv(): Unknown error (84) 的解决办法</a>
						</li>
					<li>
				<a href="/blog/2016/305.html">微信大文件的清理</a>
						</li>
					<li>
				<a href="/blog/2015/304.html">博客貌似被黑了，有空换PHP的</a>
						</li>
					<li>
				<a href="/blog/2014/303.html">使用socket方式连接Nginx优化php-fpm性能</a>
						</li>
				</ul>
		</section>		<section id="recent-comments-2" class="widget widget_recent_comments"><h2 class="widget-title">近期评论</h2><ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link">七月的路人甲</span>发表在《<a href="/blog/2007/57.html#comment-113">看《西游记》悟团队建设</a>》</li><li class="recentcomments"><span class="comment-author-link">七月的路人甲</span>发表在《<a href="/blog/2007/58.html#comment-112">讯时2.70漏洞－对讯时新闻发布系统的艰难突破</a>》</li><li class="recentcomments"><span class="comment-author-link">sunchili</span>发表在《<a href="/blog/2012/208.html#comment-111">VideoShot.exe停止工作的解决办法</a>》</li><li class="recentcomments"><span class="comment-author-link">嫁给风的女孩</span>发表在《<a href="/blog/2012/207.html#comment-109">Jinitiator控件IE崩溃及Jinitiator界面汉字方框的解决办法</a>》</li><li class="recentcomments"><span class="comment-author-link">李三</span>发表在《<a href="/blog/2013/240.html#comment-108">商务领航定制网关(EG692HW)电信管理员密码获取方法</a>》</li></ul></section><section id="archives-2" class="widget widget_archive"><h2 class="widget-title">文章归档</h2>		<ul>
			<li><a href='/blog/date/2016/01'>2016年一月</a></li>
	<li><a href='/blog/date/2015/09'>2015年九月</a></li>
	<li><a href='/blog/date/2014/11'>2014年十一月</a></li>
	<li><a href='/blog/date/2014/10'>2014年十月</a></li>
	<li><a href='/blog/date/2014/07'>2014年七月</a></li>
	<li><a href='/blog/date/2014/06'>2014年六月</a></li>
	<li><a href='/blog/date/2014/05'>2014年五月</a></li>
	<li><a href='/blog/date/2014/04'>2014年四月</a></li>
	<li><a href='/blog/date/2014/03'>2014年三月</a></li>
	<li><a href='/blog/date/2014/02'>2014年二月</a></li>
	<li><a href='/blog/date/2014/01'>2014年一月</a></li>
	<li><a href='/blog/date/2013/12'>2013年十二月</a></li>
	<li><a href='/blog/date/2013/09'>2013年九月</a></li>
	<li><a href='/blog/date/2013/08'>2013年八月</a></li>
	<li><a href='/blog/date/2013/07'>2013年七月</a></li>
	<li><a href='/blog/date/2013/06'>2013年六月</a></li>
	<li><a href='/blog/date/2013/05'>2013年五月</a></li>
	<li><a href='/blog/date/2013/04'>2013年四月</a></li>
	<li><a href='/blog/date/2012/12'>2012年十二月</a></li>
	<li><a href='/blog/date/2012/11'>2012年十一月</a></li>
	<li><a href='/blog/date/2012/09'>2012年九月</a></li>
	<li><a href='/blog/date/2012/08'>2012年八月</a></li>
	<li><a href='/blog/date/2012/07'>2012年七月</a></li>
	<li><a href='/blog/date/2012/06'>2012年六月</a></li>
	<li><a href='/blog/date/2012/05'>2012年五月</a></li>
	<li><a href='/blog/date/2012/04'>2012年四月</a></li>
	<li><a href='/blog/date/2012/03'>2012年三月</a></li>
	<li><a href='/blog/date/2012/01'>2012年一月</a></li>
	<li><a href='/blog/date/2011/11'>2011年十一月</a></li>
	<li><a href='/blog/date/2011/09'>2011年九月</a></li>
	<li><a href='/blog/date/2011/08'>2011年八月</a></li>
	<li><a href='/blog/date/2011/07'>2011年七月</a></li>
	<li><a href='/blog/date/2011/02'>2011年二月</a></li>
	<li><a href='/blog/date/2010/09'>2010年九月</a></li>
	<li><a href='/blog/date/2010/08'>2010年八月</a></li>
	<li><a href='/blog/date/2010/07'>2010年七月</a></li>
	<li><a href='/blog/date/2010/06'>2010年六月</a></li>
	<li><a href='/blog/date/2009/12'>2009年十二月</a></li>
	<li><a href='/blog/date/2009/10'>2009年十月</a></li>
	<li><a href='/blog/date/2009/08'>2009年八月</a></li>
	<li><a href='/blog/date/2009/06'>2009年六月</a></li>
	<li><a href='/blog/date/2009/05'>2009年五月</a></li>
	<li><a href='/blog/date/2009/04'>2009年四月</a></li>
	<li><a href='/blog/date/2009/03'>2009年三月</a></li>
	<li><a href='/blog/date/2009/01'>2009年一月</a></li>
	<li><a href='/blog/date/2008/12'>2008年十二月</a></li>
	<li><a href='/blog/date/2008/11'>2008年十一月</a></li>
	<li><a href='/blog/date/2008/10'>2008年十月</a></li>
	<li><a href='/blog/date/2008/09'>2008年九月</a></li>
	<li><a href='/blog/date/2008/08'>2008年八月</a></li>
	<li><a href='/blog/date/2008/07'>2008年七月</a></li>
	<li><a href='/blog/date/2008/06'>2008年六月</a></li>
	<li><a href='/blog/date/2008/04'>2008年四月</a></li>
	<li><a href='/blog/date/2008/02'>2008年二月</a></li>
	<li><a href='/blog/date/2007/12'>2007年十二月</a></li>
	<li><a href='/blog/date/2007/11'>2007年十一月</a></li>
	<li><a href='/blog/date/2007/10'>2007年十月</a></li>
	<li><a href='/blog/date/2007/09'>2007年九月</a></li>
	<li><a href='/blog/date/2007/08'>2007年八月</a></li>
	<li><a href='/blog/date/2007/07'>2007年七月</a></li>
	<li><a href='/blog/date/2007/06'>2007年六月</a></li>
	<li><a href='/blog/date/2007/05'>2007年五月</a></li>
	<li><a href='/blog/date/2007/04'>2007年四月</a></li>
		</ul>
		</section><section id="categories-2" class="widget widget_categories"><h2 class="widget-title">分类目录</h2>		<ul>
	<li class="cat-item cat-item-16"><a href="/blog/category/dotnet" >.Net</a>
</li>
	<li class="cat-item cat-item-8"><a href="/blog/category/pc_technology" >PC技术</a>
</li>
	<li class="cat-item cat-item-11"><a href="/blog/category/entertainment" >影音娱乐</a>
</li>
	<li class="cat-item cat-item-15"><a href="/blog/category/database" >数据库</a>
</li>
	<li class="cat-item cat-item-14"><a href="/blog/category/digest" >文摘</a>
</li>
	<li class="cat-item cat-item-13"><a href="/blog/category/orther" >杂货铺</a>
</li>
	<li class="cat-item cat-item-7"><a href="/blog/category/management" >管理营运</a>
</li>
	<li class="cat-item cat-item-9 current-cat"><a href="/blog/category/web_development" >网站技术</a>
</li>
	<li class="cat-item cat-item-3"><a href="/blog/category/network" >网络安全</a>
</li>
	<li class="cat-item cat-item-4"><a href="/blog/category/life" >网络生活</a>
</li>
		</ul>
</section><section id="meta-2" class="widget widget_meta"><h2 class="widget-title">功能</h2>			<ul>
						<li><a href="/wp-login.php">登录</a></li>
			<li><a href="/feed">文章<abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="/comments/feed">评论<abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="https://cn.wordpress.org/" title="基于WordPress，一个优美、先进的个人信息发布平台。">WordPress.org</a></li>			</ul>
			</section>	</aside><!-- .sidebar .widget-area -->

		</div><!-- .site-content -->

		<footer id="colophon" class="site-footer" role="contentinfo">
							<nav class="main-navigation" role="navigation" aria-label="页脚主菜单">
					<div class="menu-%e5%af%bc%e8%88%aa-container"><ul id="menu-%e5%af%bc%e8%88%aa-1" class="primary-menu"><li class="menu-item menu-item-type-taxonomy menu-item-object-category current-menu-item menu-item-309"><a href="/blog/category/web_development">网站技术</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-310"><a href="/blog/category/pc_technology">PC技术</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-311"><a href="/blog/category/orther">杂货铺</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-312"><a href="/blog/category/entertainment">影音娱乐</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-313"><a href="/blog/category/life">网络生活</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-314"><a href="/blog/category/digest">文摘</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-315"><a href="/blog/category/database">数据库</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-316"><a href="/blog/category/network">网络安全</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-317"><a href="/blog/category/management">管理营运</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-318"><a href="/blog/category/dotnet">.Net</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-323"><a href="/about_me">关于我</a></li>
</ul></div>				</nav><!-- .main-navigation -->
			
			
			<div class="site-info">
								<span class="site-title"><a href="/" rel="home">网站建设技术集锦</a></span>
				<a href="https://cn.wordpress.org/">自豪地采用WordPress</a>
			</div><!-- .site-info -->
		</footer><!-- .site-footer -->
	</div><!-- .site-inner -->
</div><!-- .site -->

<script type='text/javascript' src='/wp-content/themes/twentysixteen/js/skip-link-focus-fix.js?ver=20160816'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var screenReaderText = {"expand":"\u5c55\u5f00\u5b50\u83dc\u5355","collapse":"\u6298\u53e0\u5b50\u83dc\u5355"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/themes/twentysixteen/js/functions.js?ver=20160816'></script>
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=4.6'></script>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?6b862532551ab821a572e486bca05514";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
</body>
</html>
